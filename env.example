# ====================================
# RAG 智能问答系统 - 环境变量配置示例
# ====================================
# 使用说明：复制此文件为 .env，并填入实际的配置值

# LLM API 配置（SiliconFlow）
SILICONFLOW_API_KEY=your_api_key_here

# 主LLM模型（用于最终答案生成）
SILICONFLOW_MODEL_ID=deepseek-ai/DeepSeek-R1-Distill-Qwen-7B

# 查询增强专用模型（用于关键词生成）
# 推荐使用轻量级非推理模型，速度快且无思考过程
QUERY_ENHANCEMENT_MODEL_ID=Qwen/Qwen2.5-7B-Instruct

SILICONFLOW_API_URL=https://api.siliconflow.cn/v1/chat/completions

# Rerank API 配置
SILICONFLOW_RERANK_URL=https://api.siliconflow.cn/v1/rerank
SILICONFLOW_RERANK_MODEL=BAAI/bge-reranker-v2-m3

# 本地嵌入模型路径（请修改为你的实际路径）
LOCAL_EMBEDDING_MODEL_PATH=./models/acge_text_embedding

# 应用配置
APP_HOST=0.0.0.0
APP_PORT=8000
APP_RELOAD=True

# 日志配置
# 日志级别: DEBUG, INFO, WARNING, ERROR, CRITICAL
# DEBUG模式会显示详细的父Hash和完整内容信息，用于调试搜索准确性
LOG_LEVEL=INFO

# ==================== 向量检索参数 ====================
RETRIEVAL_COUNT=10      # 初步召回的文档数量
RERANK_TOP_K=3         # 精排后保留的文档数量

# 精排相关度阈值（强烈建议设置为 0.30 以上）
# - 0.30 (30%)：推荐值，过滤明显不相关的结果
# - 0.50 (50%)：严格模式，只保留高度相关的结果
# - 0.01 (1%)：过于宽松，不建议使用
RERANK_THRESHOLD=0.30

# ==================== 向量搜索阈值（粗排阶段）====================
# 精排模式：低阈值（20%），因为有 Rerank 二次过滤，宽松召回更多候选
VECTOR_SEARCH_THRESHOLD_WITH_RERANK=0.20

# 直取模式：高阈值（50%），因为没有二次过滤，需要保证质量
# 建议：0.50-0.60，低于此值的结果会被直接过滤
VECTOR_SEARCH_THRESHOLD_WITHOUT_RERANK=0.50

# 兼容旧配置（如果上面两个都没设置，才使用这个）
# VECTOR_SEARCH_THRESHOLD=0.20
# SIMILARITY_THRESHOLD=0.55

# 查询增强参数 (HyDE技术)
# 原问题权重，范围0-1，关键词权重 = 1 - 此值
# 推荐值: 0.6 (原问题占60%，生成关键词占40%)
QUERY_ENHANCEMENT_WEIGHT=0.6

# LLM 参数
LLM_TEMPERATURE=0

# ==================== Redis 缓存配置 ====================
REDIS_HOST=localhost          # Redis 服务器地址
REDIS_PORT=6379               # Redis 端口
REDIS_PASSWORD=               # Redis 密码（如果有，没有则留空）
REDIS_DB=0                    # Redis 数据库编号

# 语义缓存阈值
CACHE_THRESHOLD_DIRECT=0.98   # 相似度≥此值时直接返回缓存（无需用户确认）
CACHE_THRESHOLD_CONFIRM=0.95  # 相似度≥此值时提示用户确认是否使用缓存

# 缓存设置
CACHE_TTL=3600                # 缓存过期时间（秒），默认1小时
CACHE_MAX_SIZE=1000           # 最大缓存条目数，超过后 LRU 淘汰最旧的

# ==================== 管理员配置 ====================
# 管理员用户名
ADMIN_USERNAME=admin

# 管理员密码的 SHA256 哈希值
# 生成方法: python -c "import hashlib; print(hashlib.sha256('your_password'.encode()).hexdigest())"
# 默认密码: admin123 的哈希值
ADMIN_PASSWORD_HASH=240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9

# 管理员 Token 过期时间（秒），默认1小时
ADMIN_TOKEN_EXPIRE=3600
